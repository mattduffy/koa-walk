<header>
  <a id="skipnav" href="#main-content">Skip to main content</a>
  <div id="header">
    <nav id="nav" aria-label="Main">
      <div>
        <span data-action="showLogin" class="userpng"></span>
        <span data-first="" style="margin-left: 5px;">
          <% if (isAuthenticated) { %>
          <%= sessionUser?.first %>
          <% } %>
        </span>
      </div>
      <div><span data-action="showList" class="userpng"></span></div>
      <div><span data-action="showNew" class="userpng"></span></div>
    </nav>
    <script nonce="<%= nonce %>">
      document.addEventListener("DOMContentLoaded", (event) => {
        const buttons = Array.from(document.querySelector('nav#nav').children)
        buttons.forEach((b) => {
          if (b.firstElementChild.dataset) {
            const button = b.firstElementChild
            button.addEventListener('click', (e) => {
              e.preventDefault()
              e.stopPropagation()
              function actionName(fnName, a) {
                return this[fnName](a)
              }
              actionName(button.dataset.action, button.dataset.action) 
            })
          }
        })
      })

      function showLogin(o) {
        const container = document.querySelector('div#container')
        const app = container.querySelector('div#app')
        if (app.style.display !== 'none') app.style.display = 'none'
        const login = container.querySelector('div#login')
        login.style.display = 'block'
        const form = login.children[0]
        const submit = form.elements.submit
        submit.addEventListener('click', async (e) => {
          e.preventDefault()
          e.stopPropagation()
          console.log('trying to login.')
        })
        const cancel = form.elements.cancel
        cancel.addEventListener('click', (e) => {
          e.preventDefault()
          e.stopPropagation()
          login.style.display = 'none'
          app.style.display = 'block'
        })
      }
      function showList(o) {
        alert(o)
      }
      function showNew(o) {
        alert(o)
      }
      
    </script>
    <% if (locals) { %>
      <%- '<!-- html comment -->' %>
    <% } %>
  </div>
</header>
